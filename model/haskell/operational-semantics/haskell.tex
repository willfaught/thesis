% e e

\newcommand{\osfapplh}
{
\expfapp{(\expfabss{\varvarh}{\vartyh}{\first{\varexph}})}{\second{\varexph}}
}

\newcommand{\osfapprh}
{
\expsubst{\first{\varexph}}{\second{\varexph}}{\varvarh}
}

\newcommand{\osfapph}{\redruleh{\osfapplh}{\osfapprh}}

% e<t>

\newcommand{\ostappl}
{
\exptapp{(\exptabs{\tyvarh}{\varexph})}{\vartyh}
}

\newcommand{\ostappr}
{
\tysubst{\varexph}{\csbrand{\varbrand}{\vartyh}}{\tyvarh}
}

\newcommand{\ostapp}{\redruleh{\ostappl}{\ostappr}}

% fix e

\newcommand{\osfixl}
{
\expfix{(\expfabss{\varvarh}{\vartyh}{\varexph})}
}

\newcommand{\osfixr}
{
\expsubst{\varexph}{\expfix{(\expfabss{\varvarh}{\vartyh}{\varexph})}}{\varvarh}
}

\newcommand{\osfix}{\redruleh{\osfixl}{\osfixr}}

% + e e

\newcommand{\osaddl}
{
\expadd{\first{\expnum{\varnum}}}{\second{\expnum{\varnum}}}
}

\newcommand{\osaddr}
{
\expnum{\first{\varnum} + \second{\varnum}}
}

\newcommand{\osadd}{\redruleh{\osaddl}{\osaddr}}

% - e e

\newcommand{\ossubl}
{
\expsub{\first{\expnum{\varnum}}}{\second{\expnum{\varnum}}}
}

\newcommand{\ossubr}
{
\expnum{\formvar{max}(\first{\varnum} - \second{\varnum}, 0)}
}

\newcommand{\ossub}{\redruleh{\ossubl}{\ossubr}}

% if0 0 e e

\newcommand{\osiftruel}
{
\expif{\expnum{0}}{\first{\varexph}}{\second{\varexph}}
}

\newcommand{\osiftruer}
{
\first{\varexph}
}

\newcommand{\osiftrue}{\redruleh{\osiftruel}{\osiftruer}}

% if0 n e e

\newcommand{\osiffalsel}
{
\expif{\expnum{\varnum}}{\first{\varexph}}{\second{\varexph}}
}

\newcommand{\osiffalser}
{
\second{\varexph}
}

\newcommand{\osiffalse}{\redruleh{\osiffalsel}{\osiffalser} $(\varnum \neq 0)$}

% hd nil

\newcommand{\oshdnill}
{
\exphd{(\expnils{\vartyh})}
}

\newcommand{\oshdnilr}
{
\expwrongs{\vartyh}{\str{Empty \; list}}
}

\newcommand{\oshdnil}{\redruleh{\oshdnill}{\oshdnilr}}

% tl nil

\newcommand{\ostlnill}
{
\exptl{(\expnils{\vartyh})}
}

\newcommand{\ostlnilr}
{
\expwrongs{\tylist{\vartyh}}{\str{Empty \; list}}
}

\newcommand{\ostlnil}{\redruleh{\ostlnill}{\ostlnilr}}

% hd (cons e e)

\newcommand{\oshdconslh}
{
\exphd{(\expcons{\first{\varexph}}{\second{\varexph}})}
}

\newcommand{\oshdconsrh}
{
\first{\varexph}
}

\newcommand{\oshdconsh}{\redruleh{\oshdconslh}{\oshdconsrh}}

% tl (cons e e)

\newcommand{\ostlconslh}
{
\exptl{(\expcons{\first{\varexph}}{\second{\varexph}})}
}

\newcommand{\ostlconsrh}
{
\second{\varexph}
}

\newcommand{\ostlconsh}{\redruleh{\ostlconslh}{\ostlconsrh}}

% null? nil

\newcommand{\osnullnill}
{
\exppnull{(\expnils{\vartyh})}
}

\newcommand{\osnullnilr}
{
\expnum{0}
}

\newcommand{\osnullnil}{\redruleh{\osnullnill}{\osnullnilr}}

% null? (cons e e)

\newcommand{\osnullconslh}
{
\exppnull{(\expcons{\first{\varexph}}{\second{\varexph}})}
}

\newcommand{\osnullconsrh}
{
\expnum{1}
}

\newcommand{\osnullconsh}{\redruleh{\osnullconslh}{\osnullconsrh}}

% wrong t string

\newcommand{\oswrongl}
{
\redconh{\expwrongs{\vartyh}{\formvar{string}}}
}

\newcommand{\oswrongr}
{
\experr{\varstr}
}

\newcommand{\oswrong}{\redrule{\oswrongl}{\oswrongr}}

\begin{figure}[p]
\centering
\begin{tabular}{l}

\osfapph \\
\ostapp \\
\osfix \\
\osadd \\
\ossub \\
\osiftrue \\
\osiffalse \\
\oshdnil \\
\ostlnil \\
\oshdconsh \\
\ostlconsh \\
\osnullnil \\
\osnullconsh \\
\oswrong \\

\end{tabular}
\caption{Haskell operational semantics}
\label{fighos}
\end{figure}