% hm t t (mh t t e)

\newcommand{\oshmmheql}
{
	\exphm
	{
		\first
		{
			\vartyh
		}
	}
	{
		\first
		{
			\vartym
		}
	}
	{
		(
		\expmh
		{
			\second
			{
				\vartym
			}
		}
		{
			\second
			{
				\vartyh
			}
		}
		{
			\first
			{
				\varexph
			}
		}
		)
	}
}

\newcommand{\oshmmheqr}
{
	\first
	{
		\varexph
	}
}

\newcommand{\oshmmheqn}
{
	(\first{	\vartyh} $\neq$ \tylump $\wedge$ \first{\vartyh} = \second{\vartyh})
}

\newcommand
{
	\oshmmheq
}
{
	\redruleh
	{
		\oshmmheql
	}
	{
		\oshmmheqr
	}
	\oshmmheqn
}

% hm t t (mh t t e) (t /= t)

\newcommand{\oshmmhneql}
{
	\exphm
	{
		\first
		{
			\vartyh
		}
	}
	{
		\first
		{
			\vartym
		}
	}
	{
		(
		\expmh
		{
			\second
			{
				\vartym
			}
		}
		{
			\second
			{
				\vartyh
			}
		}
		{
			\varexph
		}
		)
	}
}

\newcommand{\oshmmhneqr}
{
\expwrongs{\vartyh}{\errtype}
}

\newcommand{\oshmmhneqn}
{
	(\first{	\vartyh} $\neq$ \tylump $\wedge$ \first{\vartyh} $\neq$ \second{\vartyh})
}

% hm t L (ms L v)

\newcommand{\oshmmsl}
{
\exphm{\vartyh}{\tylump}{(\expms{\cslump}{\varvalfs})}
}

\newcommand{\oshmmsr}
{
	\expwrongs
	{
		\vartyh
	}
	{
		\errvalue
	}
}

\newcommand{\oshmmsn}
{
$(\vartyh \neq \tylump)$
}

\newcommand{\oshmms}{\redruleh{\oshmmsl}{\oshmmsr} \oshmmsn}

% hm N N n

\newcommand{\oshmnuml}
{
\exphm{\tynum}{\tynum}{\expnum{\varnum}}
}

\newcommand{\oshmnumr}
{
\expnum{\varnum}
}

\newcommand{\oshmnum}{\redruleh{\oshmnuml}{\oshmnumr}}

% hm {t} {t} (nil t)

\newcommand{\oshmnill}
{
\exphm{\tylist{\vartyh}}{\tylist{\first{\vartym}}}{(\expnils{\second{\vartym}})}
}

\newcommand{\oshmnilr}
{
\expnils{\vartyh}
}

\newcommand{\oshmnil}{\redruleh{\oshmnill}{\oshmnilr}}

% hm {t} {t} (cons v v)

\newcommand{\oshmconsl}
{
\exphm{\tylist{\vartyh}}{\tylist{\vartym}}{(\expcons{\first{\varvalum}}{\second{\varvalum}})}
}

\newcommand{\oshmconsr}
{
{\expcons{(\exphm{\vartyh}{\vartym}{\first{\varvalum}})}{(\exphm{\tylist{\vartyh}}{\tylist{\vartym}}{\second{\varvalum}})}}
}

% hm (t->t) (t->t) (\x:t.e)

\newcommand{\oshmfabsl}
{
\exphm{(\tyfun{\first{\vartyh}}{\second{\vartyh}})}{(\tyfun{\first{\vartym}}{\second{\vartym}})}{(\expfabss{\varvarm}{\third{\vartym}}{\varexpm})}
}

\newcommand{\oshmfabsr}
{
\expfabss{\varvarh}{\first{\vartyh}}{\exphm{\second{\vartyh}}{\second{\vartym}}{\expfapp{((\expfabss{\varvarm}{\third{\vartym}}{\varexpm})}{(\expmh{\first{\vartym}}{\first{\vartyh}}{\varvarh})})}}
}

% hm (Au.k) (Au.k) (\\x.e)

\newcommand{\oshmtabsl}
{
\exphm{(\tyfor{\tyvarh}{\vartyh})}{(\tyfor{\first{\tyvarm}}{\vartym})}{(\exptabs{\second{\tyvarm}}{\varexpm})}
}

\newcommand{\oshmtabsr}
{
\exptabs{\tyvarh}{\exphm{\vartyh}{\tysubst{\vartym}{\tylump}{\tyvarm}}{\expsubst{\varexpm}{\tylump}{\second{\tyvarm}}}}
}

\newcommand{\oshmtabs}{\redruleh{\oshmtabsl}{\oshmtabsr}}

\begin{figure}[p]
\centering
\begin{tabular}{l}

\oshmmheq \\
\redconh{\oshmmhneql} \red \\
\redsp \redcon{\oshmmhneqr} \oshmmhneqn \\
\oshmms \\
\oshmnum \\
\oshmnil \\
\redconh{\oshmconsl} \red \\
\redsp \redcon{\oshmconsr} \\
\redconh{\oshmfabsl} \red \\
\redsp \redcon{\oshmfabsr} \\
\oshmtabs \\

\end{tabular}
\caption{Haskell-ML operational semantics}
\label{fighmos}
\end{figure}