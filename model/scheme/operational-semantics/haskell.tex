\begin{figure}[p]
\caption{The Scheme-Haskell operational semantics.}
\centering
\begin{tabular}{l}

% sh t (hs t f)

\redrules
{
	\expsh
	{
		\first
		{
			\varcsh
		}
	}
	{
		(
		\exphs
		{
			\second
			{
				\varcsh
			}
		}
		{
			\varvalfs
		}
		)
	}
}
{
	\varvalfs
} \\

% sh L (hm L k w)

\redrules
{\expsh{\cslump}{(\exphm{\cslump}{\varcsm}{\varvalfm})}}
{\expwrongd{\errvalue}} \\

% sh N n

\redrules
{\expsh{\csnum}{\expnum{\varnum}}}
{\expnum{\varnum}} \\

% sh {k} (nil t)

\redrules
{\expsh{\cslist{\varcsh}}{(\expnils{\vartyh})}}
{\expnild} \\

% sh {k} (cons e e)

\redrules
{\expsh{\cslist{\varcsh}}{(\expcons{\first{\varexph}}{\second{\varexph}})}}
{\expcons{(\expsh{\varcsh}{\first{\varexph}})}{(\expsh{\cslist{\varcsh}}{\second{\varexph}})}} \\

% sh (k->k) (\x:t.e)

\redrule
{\redcons{\expsh{(\csfun{\first{\varcsh}}{\second{\varcsh}})}{(\expfabss{\varvarh}{\vartyh}{\varexph})}}}
{} \\

\redsp \redcon{{\expfabsd{\varvars}{\expsh{\second{\varcsh}}{\expfapp{((\expfabss{\varvarh}{\vartyh}{\varexph})}{(\exphs{\first{\varcsh}}{\varvars})})}}}} \\

% sh (Au.k) (\\u.e)

\redrules
{\expsh{(\csfor{\first{\csvarh}}{\varcsh})}{(\exptabs{\second{\tyvarh}}{\varexph})}}
{\expsh{\cssubst{\varcsh}{\cslump}{\first{\csvarh}}}{\expsubst{\varexph}{\tylump}{\second{\tyvarh}}}} \\

\end{tabular}
\label{figshos}
\end{figure}