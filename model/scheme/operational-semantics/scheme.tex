\begin{figure}[p]
\centering
\begin{tabular}{l}

% (\x.e) v

\redrules
{\expfapp{(\expfabsd{\varvars}{\varexps})}{\varvalus}}
{\expsubst{\varexps}{\varvalus}{\varvars}} \\

% v v

\redrules
{\expfapp{\first{\varvalus}}{\second{\varvalus}}}
{\expwrongd{\str{Not \; a \; function}}}
$(\first{\varvalus} \neq \expfabsd{\varvars}{\varexps})$ \\

% + n n

\redrules
{\expadd{\first{\expnum{\varnum}}}{\second{\expnum{\varnum}}}}
{\expnum{\first{\varnum} + \second{\varnum}}} \\

% - n n

\redrules
{\expsub{\first{\expnum{\varnum}}}{\second{\expnum{\varnum}}}}
{\expnum{\formvar{max}(\first{\varnum} - \second{\varnum}, 0)}} \\

% o n n

\redrules
{\expop{\first{\varvalus}}{\second{\varvalus}}}
{\expwrongd{\str{Not \; a \; number}}}
$(\first{\varvalus} \neq \expnum{\varnum}$ or $\second{\varvalus} \neq \expnum{\varnum})$ \\

% if0 0 e e

\redrules
{\expif{\expnum{0}}{\first{\varexps}}{\second{\varexps}}}
{\first{\varexps}} \\

% if0 n e e

\redrules
{\expif{\expnum{\varnum}}{\first{\varexps}}{\second{\varexps}}}
{\second{\varexps}}
$(\varnum \neq 0)$ \\

% if0 v e e

\redrules
{\expif{\varvalus}{\first{\varexps}}{\second{\varexps}}}
{\expwrongd{\str{Not \; a \; number}}}
$(\varvalus \neq \expnum{\varnum})$ \\

% f nil

\redrules
{\expfield{\expnild}}
{\expwrongd{\str{Empty \; list}}} \\

% hd (cons v v)

\redrules
{\exphd{(\expcons{\first{\varvalus}}{\second{\varvalus}})}}
{\first{\varvalus}} \\

% tl (cons v v)

\redrules
{\exptl{(\expcons{\first{\varvalus}}{\second{\varvalus}})}}
{\second{\varvalus}} \\

% f v

\redrules
{\expfield{\first{\varvalus}}}
{\expwrongd{\str{Not \; a \; list}}}
$(\first{\varvalus} \neq \expnild$ and $\first{\varvalus} \neq \expcons{\second{\varvalus}}{\third{\varvalus}})$ \\

% fun? (\x.e)

\redrules
{\exppfun{(\expfabsd{\varvars}{\varexps})}}
{\expnum{0}} \\

% fun? v

\redrules
{\exppfun{\varvalus}}
{\expnum{1}}
$(\varvalus \neq \expfabsd{\varvars}{\varexps})$ \\

% list? nil

\redrules
{\expplist{\expnild}}
{\expnum{0}} \\

% list? (cons v v)

\redrules
{\expplist{(\expcons{\first{\varvalus}}{\second{\varvalus}})}}
{\expnum{0}} \\

% list? v

\redrules
{\expplist{\first{\varvalus}}}
{\expnum{1}}
$(\first{\varvalus} \neq \expnild$ and $\first{\varvalus} \neq \expcons{\second{\varvalus}}{\third{\varvalus}})$ \\

% null? nil

\redrules
{\exppnull{\expnild}}
{\expnum{0}} \\

% null? v

\redrules
{\exppnull{\varvalus}}
{\expnum{1}}
$(\varvalus \neq \expnild)$ \\

% num? n

\redrules
{\exppnum{\expnum{\varnum}}}
{\expnum{0}} \\

% num? v

\redrules
{\exppnum{\varvalus}}
{\expnum{1}}
$(\varvalus \neq \expnum{\varnum})$ \\

% wrong string

\redrule
{\redcons{\expwrongd{\formvar{string}}}}
{\experr{\varstr}}

\end{tabular}
\caption{Scheme operational semantics}
\label{sos}
\end{figure}