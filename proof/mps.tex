\begin{mps}
\label{mps}
If $\vdash_{M}e_{M}:T$ then either $e_{M}$ is a value, $e_{M}\rightarrow e_{M}'$ for some $e_{M}'$, or $e_{M}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.
\input{mi.tex}
\input{muot.tex}
\input{mcf.tex}
\begin{proof}
Straightforward induction on typing derivations of $\vdash_{M}e_{M}:T$.
\begin{mps-case-1}
$e_{M}=x$

Cannot occur because $e_{M}$ is closed.
\end{mps-case-1}
\begin{mps-case-2}
$e_{M}=\lambda x:T_{1}.e_{M}^{1}$

$\lambda x:T_{1}.e_{M}^{1}$ is a value.
\end{mps-case-2}
\begin{mps-case-3}
$e_{M}=\Lambda X.e_{M}^{1}$

$\Lambda X.e_{M}^{1}$ is a value.
\end{mps-case-3}
\begin{mps-case-4}
$e_{M}=\mathtt{cons}\;e_{M}^{1}\;e_{M}^{2}$

$\mathtt{cons}\;e_{M}^{1}\;e_{M}^{2}$ is a value.
\end{mps-case-4}
\begin{mps-case-5}
$e_{M}=\mathtt{nil}$

$\mathtt{nil}$ is a value.
\end{mps-case-5}
\begin{mps-case-6}
$e_{M}=\overline{n}$

$\overline{n}$ is a value.
\end{mps-case-6}
\begin{mps-case-7}
$e_{M}=e_{M}^{1}\;e_{M}^{2}$

By the induction hypothesis, either $e_{M}^{1}$ is a value, $e_{M}^{1}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$, or $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:T_{1}\rightarrow T_{2}$ for some $T_{1}$ and $T_{2}$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{1}=\lambda x:T_{1}.e_{M}^{3}$ for some $x$ and $e_{M}^{3}$ by canonical forms (Lemma \ref{hcf}).  Therefore $(\lambda x:T.e_{M}^{3})\;e_{M}^{2}\rightarrow e_{M}^{3}[e_{M}^{2}/x]$.  If $e_{M}^{1}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$ then $e_{M}^{1}\;e_{M}^{2}\rightarrow e_{M}^{3}\;e_{M}^{2}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $e_{M}^{1}\;e_{M}^{2}\rightarrow$ \emph{\textbf{Error}:\;string}.
\end{mps-case-7}
\begin{mps-case-8}
$e_{M}=e_{M}^{1}\;\lbrace T_{1}\rbrace$

By the induction hypothesis, either $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$, $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}, or $e_{M}^{1}$ is a value.  If $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$ then $e_{M}^{1}\;\lbrace T_{1}\rbrace\rightarrow e_{M}^{2}\;\lbrace T_{1}\rbrace$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $e_{M}^{1}\;\lbrace T_{1}\rbrace\rightarrow$ \emph{\textbf{Error}:\;string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:\forall X.T_{2}$ for some $X$ and $T_{2}$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and either $e_{M}^{1}=\Lambda X.e_{M}^{2}$ for some $e_{M}^{2}$ or $e_{M}^{1}=\,^{\forall X.T_{2}}HS\;v_{S}$ for some $v_{S}$ by canonical forms (Lemma \ref{hcf}).
\end{mps-case-8}
\begin{mps-case-8-1}
$e_{M}^{1}=\Lambda X.e_{M}^{2}$

$(\Lambda X.e_{M}^{2})\;\lbrace T_{1}\rbrace\rightarrow e_{M}^{2}[T_{1}/X]$.
\end{mps-case-8-1}
\begin{mps-case-8-2}
$e_{M}^{1}=\,^{\forall X.T_{2}}HS\;v_{S}$

$(^{\forall X.T_{2}}HS\;v_{S})\;\lbrace T_{1}\rbrace\rightarrow\,^{T_{2}[T_{1}^{a}/X]}HS\;v_{S}$.
\end{mps-case-8-2}
\begin{mps-case-9}
$e_{M}=\mathtt{if0}\;e_{M}^{1}\;e_{M}^{2}\;e_{M}^{3}$

By the induction hypothesis, either $e_{M}^{1}$ is a value, $e_{M}^{1}\rightarrow e_{M}^{4}$ for some $e_{M}^{4}$, or $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:N$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{1}=\overline{n}$ for some $\overline{n}$ by canonical forms (Lemma \ref{hcf}).  Therefore $\mathtt{if0}\;e_{M}^{1}\;e_{M}^{2}\;e_{M}^{3}\rightarrow e_{M}^{2}$ if $e_{M}^{1}=\overline{0}$ or $\mathtt{if0}\;e_{M}^{1}\;e_{M}^{2}\;e_{M}^{3}\rightarrow e_{M}^{3}$ if $e_{M}^{1}\neq\overline{0}$.  If $e_{M}^{1}\rightarrow e_{M}^{4}$ for some $e_{M}^{4}$ then $\mathtt{if0}\;e_{M}^{1}\;e_{M}^{2}\;e_{M}^{3}\rightarrow \mathtt{if0}\;e_{M}^{4}\;e_{M}^{2}\;e_{M}^{3}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $\mathtt{if0}\;e_{M}^{1}\;e_{M}^{2}\;e_{M}^{3}\rightarrow$ \emph{\textbf{Error}:\;string}.
\end{mps-case-9}
\begin{mps-case-10}
$e_{M}=o\;e_{M}^{1}\;e_{M}^{2}$

By the induction hypothesis, either $e_{M}^{1}$ is a value, $e_{M}^{1}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$, or $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:N$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{1}=\overline{n_{1}}$ for some $\overline{n_{1}}$ by canonical forms (Lemma \ref{hcf}).  If $e_{M}^{1}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$ then $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow o\;e_{M}^{3}\;e_{M}^{2}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow$ \emph{\textbf{Error}:\;string}.

By the induction hypothesis, either $e_{M}^{2}$ is a value, $e_{M}^{2}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$, or $e_{M}^{2}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{2}$ is a value then $e_{M}^{2}:N$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{2}=\overline{n_{2}}$ for some $\overline{n_{2}}$ by canonical forms (Lemma \ref{hcf}).  If $e_{M}^{2}\rightarrow e_{M}^{3}$ for some $e_{M}^{3}$ then $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow o\;e_{M}^{1}\;e_{M}^{3}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow$ \emph{\textbf{Error}:\;string}.

If $e_{M}^{1}=\overline{n_{1}}$ and $e_{M}^{2}=\overline{n_{2}}$ then $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow \overline{n_{1}+n_{2}}$ if $o=+$ or $o\;e_{M}^{1}\;e_{M}^{2}\rightarrow \overline{max(n_{1}-n_{2},0)}$ if $o=-$.
\end{mps-case-10}
\begin{mps-case-11}
$e_{M}=f\;e_{M}^{1}$

By the induction hypothesis, either $e_{M}^{1}$ is a value, $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$, or $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:[T]$ for some $T$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{1}=\mathtt{cons}\;e_{M}^{2}\;e_{M}^{3}$ for some $e_{M}^{2}$ and $e_{M}^{3}$ by canonical forms (Lemma \ref{hcf}).  Therefore $f\;(\mathtt{cons}\;e_{M}^{2}\;e_{M}^{3})\rightarrow e_{M}^{2}$ if $f=\mathtt{hd}$ or $f\;(\mathtt{cons}\;e_{M}^{2}\;e_{M}^{3})\rightarrow e_{M}^{3}$ if $f=\mathtt{tl}$.  If $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$ then $f\;e_{M}^{1}\rightarrow f\;e_{M}^{2}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $f\;e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string}.
\end{mps-case-11}
\begin{mps-case-12}
$e_{M}=\mathtt{fix}\;e_{M}^{1}$

By the induction hypothesis, either $e_{M}^{1}$ is a value, $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$, or $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}.  If $e_{M}^{1}$ is a value then $e_{M}^{1}:T_{1}\rightarrow T_{2}$ for some $T_{1}$ and $T_{2}$ by inversion (Lemma \ref{hi}) and uniqueness of types (Lemma \ref{huot}) and $e_{M}^{1}=\lambda x:T_{1}.e_{M}^{2}$ for some $x$ and $e_{M}^{2}$ by canonical forms (Lemma \ref{hcf}).  Therefore $\mathtt{fix}\;(\lambda x:T_{1}.e_{M}^{2})\rightarrow e_{M}^{2}[\mathtt{fix}\;(\lambda x:T_{1}.e_{M}^{2})/x]$.  If $e_{M}^{1}\rightarrow e_{M}^{2}$ for some $e_{M}^{2}$ then $\mathtt{fix}\;e_{M}^{1}\rightarrow\mathtt{fix}\;e_{M}^{2}$.  If $e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $\mathtt{fix}\;e_{M}^{1}\rightarrow$ \emph{\textbf{Error}:\;string}.
\end{mps-case-12}
\begin{mps-case-13}
$e_{H}=\,^{T}MH^{T}\;e_{H}^{1}$

By the Haskell progress theorem (Theorem \ref{hps}), either $e_{H}^{1}\rightarrow e_{H}^{2}$ for some $e_{H}^{2}$, $e_{H}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}, or $e_{H}^{1}$ is a value.  If $e_{H}^{1}\rightarrow e_{H}^{2}$ for some $e_{H}^{2}$ then $^{T}HS\;e_{H}^{1}\rightarrow\,^{T}HS\;e_{H}^{2}$.  If $e_{H}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $^{T}HS\;e_{H}^{1}\rightarrow$ \emph{\textbf{Error}:\;string}.  If $e_{H}^{1}$ is a value then $T$ determines its reduction:
\begin{mps-case-13-1}
$T=N$

$e_{H}^{1}=\overline{n}$ for some $\overline{n}$ by canonical forms (Lemma \ref{hcf}).  $^{N}MH^{N}\;\overline{n}\rightarrow\overline{n}$.
\end{mps-case-13-1}
\begin{mps-case-13-2}
$T=T_{1}\rightarrow T_{2}$

$e_{H}^{1}=\lambda x_{1}:T_{1}.e_{H}^{2}$ for some $x_{1}$ and $e_{H}^{2}$ by canonical forms (Lemma \ref{hcf}).  $^{T_{1}\rightarrow T_{2}}MH^{T_{1}\rightarrow T_{2}}\;(\lambda x_{1}:T_{1}.e_{H}^{2})\rightarrow\lambda x_{2}:T_{1}[T_{i}/T^{a}_{i}].(^{T_{2}}MH^{T_{2}}\;((\lambda x_{1}:T_{1}.e_{H}^{2})\;(^{T_{1}}HM^{T_{1}}\;x_{2})))$.
\end{mps-case-13-2}
\begin{mps-case-13-3}
$T=\forall X_{1}.T_{1}$

$e_{H}^{1}=\Lambda X_{1}.e_{H}^{2}$ for some $e_{H}^{2}$ by canonical forms (Lemma \ref{hcf}).  $^{\forall X_{1}.T_{1}}MH^{\forall X_{1}.T_{1}}\;(\Lambda X_{1}.e_{H}^{2})\rightarrow\Lambda X_{2}.(^{T_{1}[X_{2}/X_{1}]}MH^{T_{1}[X_{2}/X_{1}]}\;((\Lambda X_{1}.e_{H}^{2})\;\lbrace X_{2}\rbrace))$.
\end{mps-case-13-3}
\begin{mps-case-13-4}
$T=[T_{1}]$

$e_{H}^{1}=\mathtt{cons}\;e_{H}^{2}\;e_{H}^{3}$ for some $e_{H}^{2}$ and $e_{H}^{3}$ by canonical forms (Lemma \ref{hcf}).  $^{[T_{1}]}MH^{[T_{1}]}\;(\mathtt{cons}\;e_{H}^{2}\;e_{H}^{3})\rightarrow\mathtt{cons}\;(^{T_{1}}MH^{T_{1}}\;e_{H}^{2})\;(^{[T_{1}]}MH^{[T_{1}]}\;e_{H}^{3})$.
\end{mps-case-13-4}
\begin{mps-case-13-5}
$T=L$

Cannot occur because $L$ occurs only in $^{L}MS\;e_{S}$.
\end{mps-case-13-5}
\begin{mps-case-13-6}
$T=T_{1}^{a}$

Cannot occur because $T_{1}^{a}$ occurs only in $^{T_{1}^{a}}MS\;e_{S}$.
\end{mps-case-13-6}
\end{mps-case-13}
\begin{mps-case-14}
$e_{M}=\,^{T}MS\;e_{S}^{1}$

By the Scheme progress theorem (Theorem \ref{sps}), either $e_{S}^{1}\rightarrow e_{S}^{2}$ for some $e_{S}^{2}$, $e_{S}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string}, or $e_{S}^{1}$ is a value.  If $e_{S}^{1}\rightarrow e_{S}^{2}$ for some $e_{S}^{2}$ then $^{T}HS\;e_{S}^{1}\rightarrow\,^{T}HS\;e_{S}^{2}$.  If $e_{S}^{1}\rightarrow$ \emph{\textbf{Error}:\;string} for some \emph{string} then $^{T}HS\;e_{S}^{1}\rightarrow$ \emph{\textbf{Error}:\;string}.  If $e_{S}^{1}$ is a value then $T$ determines its reduction:
\begin{mps-case-14-1}
$T=N$

If $e_{S}^{1}=\overline{n}$ for some $\overline{n}$ then $^{N}MS\;\overline{n}\rightarrow\overline{n}$.  Otherwise, $^{N}MS\;e_{S}^{1}\rightarrow\,^{N}MS\;(\mathtt{wrong}\;\mathrm{``Not\;a\;number"})$.
\end{mps-case-14-1}
\begin{mps-case-14-2}
$T=T_{1}\rightarrow T_{2}$

If $e_{S}^{1}=\lambda x_{1}.e_{S}^{2}$ for some $x_{1}$ and $e_{S}^{2}$ then $^{T_{1}\rightarrow T_{2}}MS\;(\lambda x_{1}.e_{S}^{2})\rightarrow\lambda x_{2}:T_{1}[T_{i}/T^{a}_{i}].(^{T_{2}}MS\;((\lambda x_{1}.e_{S}^{2})\;(SM^{T_{1}}\;x_{2})))$.  Otherwise, $^{T_{1}\rightarrow T_{2}}MS\;e_{S}^{1}\rightarrow\,^{T_{1}\rightarrow T_{2}}MS\;(\mathtt{wrong}\;\mathrm{``Not\;a\;procedure"})$.
\end{mps-case-14-2}
\begin{mps-case-14-3}
$T=\forall X.T_{1}$

$^{\forall X.T_{1}}MS\;e_{S}^{1}$ is a value.
\end{mps-case-14-3}
\begin{mps-case-14-4}
$T=[T_{1}]$

If $e_{S}^{1}=\mathtt{cons}\;v_{S}^{2}\;v_{S}^{3}$ for some $v_{S}^{2}$ and $v_{S}^{3}$ then $^{[T_{1}]}MS\;(\mathtt{cons}\;v_{S}^{2}\;v_{S}^{3})\rightarrow\mathtt{cons}\;(^{T_{1}}MS\;v_{S}^{2})\;(^{[T_{1}]}MS\;v_{S}^{3})$.  Otherwise, $^{[T_{1}]}MS\;e_{S}^{1}\rightarrow\,^{[T_{1}]}MS\;(\mathtt{wrong}\;\mathrm{``Not\;a\;list"})$.
\end{mps-case-14-4}
\begin{mps-case-14-5}
$T=L$

$^{L}MS\;e_{S}^{1}$ is a value.
\end{mps-case-14-5}
\begin{mps-case-14-6}
$T=T_{1}^{a}$

If $e_{S}^{1}=SM^{T_{1}^{a}}\;v_{M}^{1}$ then $^{T_{1}^{a}}MS\;(SM^{T_{1}^{a}}\;v_{M}^{1})\rightarrow v_{M}^{1}$.  Otherwise, $^{T_{1}^{a}}MS\;e_{S}^{1}\rightarrow\,^{T_{1}^{a}}MS\;(\mathtt{wrong}\;\mathrm{``Parametricity\;violated"})$.
\end{mps-case-14-6}
\end{mps-case-14}
\end{proof}
\end{mps}