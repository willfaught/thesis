\begin{theorem}{ML Progress}

\label{thmpsm}

If \judem{}{\first{\varexpm}}{\vartym} then \pshyp{\first{\varexpm}}{\second{\varexpm}}.

\begin{proof}

By structural induction on \first{\varexpm}.  Cases similar to Haskell cases are omitted.

% mh t t e

\newcommand{\psmh}{\expmh{\first{\vartym}}{\first{\vartyh}}{\first{\varexph}}\xspace}

\begin{case}{\psmh}

\pshypby
{\first{\varexph}}
{\second{\varexph}}
\pscasestwo
{\first{\varexph}}
{\first{\vartym}}
{\first{\vartyh}}
{\psmh}

% TODO:

TODO

\begin{subcase}{}

\end{subcase}

\pssub
{\first{\varexph}}
{\second{\varexph}}
{\psmh}
{\expmh{\first{\vartym}}{\first{\vartyh}}{\second{\varexph}}}
\pserr
{\first{\varexph}}
{\psmh}

\end{case}

% e e

\newcommand{\psfappm}{\expfapp{\first{\varexpm}}{\second{\varexpm}}}
\renewcommand{\x}{\expfabss{\varvarm}{\first{\vartym}}{\third{\varexpm}}}

\begin{case}{\psfappm}

\pshypby
{\first{\varexpm}}
{\third{\varexpm}}
\psvalifeqm
{\first{\varexpm}}
{\tyfun{\first{\vartym}}{\second{\vartym}}}
{\x}
\pssub
{\first{\varexpm}}
{\third{\varexpm}}
{\psfappm}
{\expfapp{\third{\varexpm}}{\second{\varexpm}}}
\pserr
{\first{\varexpm}}
{\psfappm}
\pshypby
{\second{\varexpm}}
{\third{\varexpm}}
\pssuband
{\second{\varexpm}}
{\third{\varexpm}}
{\first{\varexpm}}
{\psfappm}
{\expfapp{\first{\varexpm}}{\third{\varexpm}}}
\pserrand
{\second{\varexpm}}
{\first{\varexpm}}
{\psfappm}
\psredif
{\first{\varexpm}}
{\second{\varexpm}}
{\expfapp{(\x)}{\second{\varexpm}}}
{\expsubst{\third{\varexpm}}{\second{\varexpm}}{\varvarm}}

\end{case}

% cons e e

\newcommand{\psconsem}{\expcons{\first{\varexpm}}{\second{\varexpm}}\xspace}

\begin{case}{\psconsem}

\pshypby
{\first{\varexpm}}
{\third{\varexpm}}
\pssub
{\first{\varexpm}}
{\third{\varexpm}}
{\psconsem}
{\expcons{\third{\varexpm}}{\second{\varexpm}}}
\pserr
{\first{\varexpm}}
{\psconsem}
\pssuband
{\second{\varexpm}}
{\third{\varexpm}}
{\first{\varexpm}}
{\psconsem}
{\expcons{\third{\varexpm}}{\second{\varexpm}}}
\pserrand
{\second{\varexpm}}
{\first{\varexpm}}
{\psconsem}
\psvaliftwo
{\first{\varexpm}}
{\second{\varexpm}}
{\psconsem is an \prouv.}

\end{case}

\end{proof}

\end{theorem}
