\begin{theorem}{ML Progress}

\label{thmpsm}

If \judem{}{\varexpm}{\vartym} then \pshyp{\first{\varexpm}}{\second{\varexpm}}.

\begin{proof}

By structural induction on \varexpm.  Cases similar to Haskell cases are omitted.

% cons w w

\newcommand{\psconswm}{\expcons{\first{\varvalum}}{\second{\varvalum}}\xspace}

\begin{case}{\psconswm}

\psconswm is a \profv.

\end{case}

% e e

\newcommand{\psfappm}{\expfapp{\first{\varexpm}}{\second{\varexpm}}}
\renewcommand{\x}{\expfabss{\varvarm}{\first{\vartym}}{\third{\varexpm}}}

\begin{case}{\psfappm}

\pshypby
{\first{\varexpm}}
{\third{\varexpm}}
\psvalifeqm
{\first{\varexpm}}
{\tyfun{\first{\vartym}}{\second{\vartym}}}
{\x}
\pssub
{\first{\varexpm}}
{\third{\varexpm}}
{\psfappm}
{\expfapp{\third{\varexpm}}{\second{\varexpm}}}
\pserr
{\first{\varexpm}}
{\psfappm}
\pshypby
{\second{\varexpm}}
{\third{\varexpm}}
\pssuband
{\second{\varexpm}}
{\third{\varexpm}}
{\first{\varexpm}}
{\psfappm}
{\expfapp{\first{\varexpm}}{\third{\varexpm}}}
\pserrand
{\second{\varexpm}}
{\first{\varexpm}}
{\psfappm}
\psred
{\expfapp{(\x)}{\second{\varexpm}}}
{\expsubst{\third{\varexpm}}{\second{\varexpm}}{\varvarm}}

\end{case}

% cons e e

\newcommand{\psconsem}{\expcons{\first{\varexpm}}{\second{\varexpm}}\xspace}

\begin{case}{\psconsem}

\pshypby
{\first{\varexpm}}
{\third{\varexpm}}
\pssub
{\first{\varexpm}}
{\third{\varexpm}}
{\psconsem}
{\expcons{\third{\varexpm}}{\second{\varexpm}}}
\pserr
{\first{\varexpm}}
{\psconsem}
\pssuband
{\second{\varexpm}}
{\third{\varexpm}}
{\first{\varexpm}}
{\psconsem}
{\expcons{\third{\varexpm}}{\second{\varexpm}}}
\pserrand
{\second{\varexpm}}
{\first{\varexpm}}
{\psconsem}
\psvaliftwo
{\first{\varexpm}}
{\second{\varexpm}}
{\psconsem is a \profv.}

\end{case}

\end{proof}

\end{theorem}
