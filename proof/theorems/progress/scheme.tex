\begin{theorem}{Scheme Progress}

\label{thmpss}

If \judes{}{\first{\varexps}}{\tytst} then \pshyp{\first{\varexps}}{\second{\varexps}}.

\begin{proof}

By structural induction on \first{\varexps}.  Cases similar to Haskell and ML cases are omitted.

% TODO:
% sh k e

\begin{case}

$e_{S}=SH^{T}$ $e_{H}$

$SH^{T}$ $e_{H}$ is an unforced value.

TODO

\end{case}

% sm k e

\newcommand{\pssm}{\expsm{\first{\varcsm}}{\first{\varexpm}}}

\begin{case}{\pssm}

\pshypby
{\first{\varexpm}}
{\second{\varexpm}}
\pssub
{\first{\varexpm}}
{\second{\varexpm}}
{\pssm}
{\expsm{\first{\varcsm}}{\second{\varexpm}}}
\pserr
{\first{\varexpm}}
{\pssm}
\pscasesone
{\first{\varexpm}}
{\first{\varcsm}}
{\pssm}

% L

\renewcommand{\x}{\expmh{\cslump}{\first{\varcsh}}{\first{\varexph}}}
\renewcommand{\y}{\expms{\cslump}{\first{\varvalfs}}}

\begin{subcase}{\cslump}

\psvalcanin
{\first{\varexpm}}
{\x, \y}
\psred
{\expsm{\cslump}{(\x)}}
{\expwrongd{\errvalue}}
\psred
{\expsm{\cslump}{(\y)}}
{\first{\varvalfs}}

\end{subcase}

% N

\renewcommand{\x}{\first{\expnum{\varnum}}}

\begin{subcase}{\csnum}

\psvalcaneq
{\first{\varexpm}}
{\x}
\psred
{\expsm{\csnum}{\x}}
{\x}

\end{subcase}

% {k}

\renewcommand{\x}{\cslist{\second{\varcsm}}}
\renewcommand{\y}{\expnils{\first{\vartym}}}
\renewcommand{\z}{\expcons{\first{\varvalum}}{\second{\varvalum}}}

\begin{subcase}{\x}

\psvalcanin
{\first{\varexpm}}
{\y, \z}
\psred
{\expsm{\x}{(\y)}}
{\expnild}
\psred
{\expsm{\x}{(\z)}}
{\expcons{(\expsm{\second{\varcsm}}{\first{\varvalum}})}{(\expsm{\x}{\second{\varvalum}})}}

\end{subcase}

% k->k

\renewcommand{\x}{\csfun{\second{\varcsm}}{\third{\varcsm}}}
\renewcommand{\y}{\expfabss{\first{\varvarm}}{\first{\vartym}}{\first{\varexpm}}}

\begin{subcase}{\x}

\psvalcaneq
{\first{\varexpm}}
{\y}
\psred
{\expsm{(\x)}{(\y)}}
{\expfabsd{\first{\varvars}}{\expsm{\third{\varcsm}}{(\expfapp{(\y)}{(\expms{\second{\varcsm}}{\first{\varvars}})})}}}

\end{subcase}

% Au.k

\renewcommand{\x}{\csfor{\first{\csvarm}}{\second{\varcsm}}}
\renewcommand{\y}{\exptabs{\second{\tyvarm}}{\second{\varexpm}}}

\begin{subcase}{\x}

\psvalcaneq
{\first{\varexpm}}
{\y}
\psred
{\expsm{(\x)}{(\y)}}
{\expsm{\cssubst{\second{\varcsm}}{\cslump}{\first{\csvarm}}}{\expsubst{\second{\varexpm}}{\tylump}{\second{\tyvarm}}}}

\end{subcase}

% b.t

\renewcommand{\x}{\csbrand{\first{\varbrand}}{\first{\vartym}}}

\begin{subcase}{\x}

\expsm{(\x)}{\first{\varexpm}} is an \prouv.

\end{subcase}

\end{case}

\end{proof}

\end{theorem}
